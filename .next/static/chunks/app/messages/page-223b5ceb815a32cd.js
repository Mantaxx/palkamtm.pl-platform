(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9451],{508:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(5105).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2686:(e,s,a)=>{Promise.resolve().then(a.bind(a,4121))},4121:(e,s,a)=>{"use strict";a.d(s,{MessagesPage:()=>u});var t=a(5155),r=a(9591),l=a(4837),i=a(9119),n=a(6956),c=a(5105);let o=(0,c.A)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);var d=a(508);let m=(0,c.A)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var x=a(5239),h=a(2115);function g(e){let{conversations:s,onSelectConversation:a,selectedConversationId:r}=e;return(0,t.jsx)("div",{className:"w-full md:w-80 shrink-0",children:(0,t.jsxs)(l.X,{variant:"glass",className:"h-full",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,t.jsxs)("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,t.jsx)(o,{className:"w-5 h-5"}),"Wiadomości"]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===s.length?(0,t.jsxs)("div",{className:"p-4 text-center text-gray-400",children:[(0,t.jsx)(o,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"Brak wiadomości"})]}):(0,t.jsx)("div",{className:"space-y-1",children:s.map(e=>(0,t.jsx)("button",{onClick:()=>a(e.id),className:"w-full p-4 text-left hover:bg-gray-700/50 transition-colors ".concat(r===e.id?"bg-gray-700/50":""),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center shrink-0",children:e.otherParticipant.image?(0,t.jsx)(x.default,{src:e.otherParticipant.image,alt:e.otherParticipant.name,width:40,height:40,className:"rounded-full"}):(0,t.jsx)(d.A,{className:"w-5 h-5 text-gray-300"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("h3",{className:"font-medium text-white truncate",children:e.otherParticipant.name}),e.unreadCount>0&&(0,t.jsx)("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:e.unreadCount})]}),e.lastMessage&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-sm text-gray-300 truncate",children:e.lastMessage.content}),(0,t.jsx)("span",{className:"text-xs text-gray-400 ml-2 shrink-0",children:(0,i.A)(new Date(e.lastMessageAt),"HH:mm",{locale:n.A})})]})]})]})},e.id))})})]})})}function p(e){let{conversationId:s,otherParticipant:a,messages:c,onSendMessage:g,isLoading:p=!1,userId:u}=e,[y,f]=(0,h.useState)(""),j=(0,h.useRef)(null);(0,h.useEffect)(()=>{var e;null==(e=j.current)||e.scrollIntoView({behavior:"smooth"})},[c]);let v=()=>{y.trim()&&(g(y.trim()),f(""))};return s&&a?(0,t.jsx)("div",{className:"flex-1 flex flex-col",children:(0,t.jsxs)(l.X,{variant:"glass",className:"h-full flex flex-col",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center",children:a.image?(0,t.jsx)(x.default,{src:a.image,alt:a.name,width:40,height:40,className:"rounded-full"}):(0,t.jsx)(d.A,{className:"w-5 h-5 text-gray-300"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-white",children:a.name}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:a.email})]})]})}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===c.length?(0,t.jsx)("div",{className:"text-center text-gray-400 py-8",children:(0,t.jsx)("p",{children:"Brak wiadomości w tej konwersacji"})}):c.map(e=>(0,t.jsx)("div",{className:"flex ".concat(e.senderId===u?"justify-end":"justify-start"),children:(0,t.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg ".concat(e.senderId===u?"bg-blue-500 text-white":"bg-gray-700 text-white"),children:[(0,t.jsx)("p",{className:"text-sm",children:e.content}),(0,t.jsx)("p",{className:"text-xs opacity-70 mt-1",children:(0,i.A)(new Date(e.createdAt),"HH:mm",{locale:n.A})})]})},e.id)),(0,t.jsx)("div",{ref:j})]}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:y,onChange:e=>f(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:"Napisz wiadomość...",className:"flex-1 px-3 py-2 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-blue-500 focus:outline-none",disabled:p}),(0,t.jsx)(r.R,{onClick:v,disabled:!y.trim()||p,className:"px-4 py-2",children:(0,t.jsx)(m,{className:"w-4 h-4"})})]})})]})}):(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center text-gray-400",children:[(0,t.jsx)(o,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{className:"text-lg",children:"Wybierz konwersację"}),(0,t.jsx)("p",{className:"text-sm",children:"Aby rozpocząć rozmowę"})]})})}function u(e){let{userId:s}=e,[a,r]=(0,h.useState)([]),[l,i]=(0,h.useState)(),[n,c]=(0,h.useState)([]),[o,d]=(0,h.useState)(),[m,x]=(0,h.useState)(!1);(0,h.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/messages");if(e.ok){let s=await e.json();r(s.conversations)}}catch(e){console.error("Error fetching conversations:",e)}})()},[]),(0,h.useEffect)(()=>{l&&(async()=>{x(!0);try{let e=await fetch("/api/messages/".concat(l));if(e.ok){let s=await e.json();c(s.messages),d(s.conversation.otherParticipant)}}catch(e){console.error("Error fetching messages:",e)}finally{x(!1)}})()},[l]);let u=async e=>{if(l)try{let a=await fetch("/api/messages/".concat(l),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})});if(a.ok){let e=await a.json();c(a=>[...a,{...e.message,senderId:s}])}}catch(e){console.error("Error sending message:",e)}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-700",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-32",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"Wiadomości"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Komunikuj się z innymi użytkownikami"})]}),(0,t.jsxs)("div",{className:"flex gap-6 h-[600px]",children:[(0,t.jsx)(g,{conversations:a,onSelectConversation:e=>{i(e)},selectedConversationId:l}),(0,t.jsx)(p,{conversationId:l,otherParticipant:o,messages:n,onSendMessage:u,isLoading:m,userId:s})]})]})})}},4837:(e,s,a)=>{"use strict";a.d(s,{X:()=>l});var t=a(5155),r=a(5947);function l(e){let{children:s,className:a="",variant:l="default",glow:i=!1,hover:n=!0,delay:c=0,intensity:o="medium"}=e,d={low:{scale:1.01,y:-2},medium:{scale:1.02,y:-4},high:{scale:1.05,y:-6}}[o];return(0,t.jsx)(r.P.div,{initial:{opacity:0,y:50,scale:.9,rotateX:-10},animate:{opacity:1,y:0,scale:1,rotateX:0},whileHover:n?{scale:d.scale,y:d.y,rotateX:5,rotateY:5}:{},transition:{initial:{duration:.8,delay:c,type:"spring",stiffness:100},hover:{duration:.3,type:"spring",stiffness:300}},className:"\n        ".concat({default:"card",glass:"card-glass","3d":"card-3d",floating:"card-floating",gradient:"card-gradient"}[l],"\n        ").concat(i?"animate-glow3D":"","\n        ").concat(n?"hover-3d-lift":"","\n        transform-3d perspective-1000\n        ").concat(a,"\n      "),children:s})}},9591:(e,s,a)=>{"use strict";a.d(s,{R:()=>n});var t=a(5155),r=a(5947),l=a(2619),i=a.n(l);function n(e){let{children:s,onClick:a,href:l,type:n="button",variant:c="primary",size:o="md",className:d="",disabled:m=!1,title:x,ariaLabel:h,glow:g=!0,intensity:p="medium"}=e,u={low:{scale:1.02,y:-2},medium:{scale:1.05,y:-4},high:{scale:1.08,y:-6}}[p],y="\n    ".concat({primary:"btn-primary",secondary:"btn-secondary",outline:"btn-outline",ghost:"btn-ghost",glass:"glass-morphism hover:glass-morphism-strong"}[c],"\n    ").concat({sm:"px-3 py-2 text-sm",md:"px-4 py-3 text-base",lg:"px-6 py-4 text-lg"}[o],"\n    ").concat(g?"animate-glow3D":"","\n    ").concat(m?"opacity-50 cursor-not-allowed":"hover-3d-lift","\n    transform-3d perspective-1000\n    ").concat(d,"\n  "),f={whileHover:m?{}:{scale:u.scale,y:u.y,rotateX:5,rotateY:5},whileTap:m?{}:{scale:.98,y:0},transition:{type:"spring",stiffness:300,damping:20}};return l?(0,t.jsx)(r.P.div,{...f,children:(0,t.jsx)(i(),{href:l,title:x,"aria-label":h,className:y,children:(0,t.jsx)("span",{className:"relative z-10",children:s})})}):(0,t.jsx)(r.P.button,{type:n,onClick:a,disabled:m,title:x,"aria-label":h,className:y,...f,children:(0,t.jsx)("span",{className:"relative z-10",children:s})})}}},e=>{e.O(0,[6635,5481,1934,8441,1255,7358],()=>e(e.s=2686)),_N_E=e.O()}]);